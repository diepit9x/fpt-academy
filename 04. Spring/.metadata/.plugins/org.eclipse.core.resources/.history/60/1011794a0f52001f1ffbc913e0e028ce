<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<h2>View Content</h2>
<div class="profile-box">
  <div class="login-header">View content list</div>
  <div class="profile-body">
    <table class="table table-bordered">
      <thead>
        <tr>
          <th>#</th>
          <th>Title</th>
          <th>Brief</th>
          <th>Create Date</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody id="content-table-body">
      </tbody>
    </table>
  </div>
</div>
<script>
$(document).ready(function() {
    $.ajax({
        url: "${pageContext.request.contextPath}/content/all-contents",
        type: "GET",
        dataType: "json",
        success: function(response) {
            const contentList = response.object;
            let rows = '';
            debugger;
            contentList.forEach(function(content) {
                const createDate = new Date(content.createDate[0], content.createDate[1] - 1, content.createDate[2], content.createDate[3], content.createDate[4], content.createDate[5]);
                const formattedDate = createDate.toLocaleString('en-GB', { day: '2-digit', month: '2-digit', year: 'numeric', hour: '2-digit', minute: '2-digit' });

                rows += '<tr><td>'+content.id+'</td><td>'+content.title+'</td><td>'+content.brief+'</td><td>'+formattedDate+'</td><td><button class="btn btn-info load-page" ref="/pages/form-content/'+content.id+'">Edit</button></td></tr>';
            });

            $('#content-table-body').html(rows);
        },
        error: function(xhr) {
            const response = xhr.responseJSON;
            let msg = response && response.object ? response.object : "Có lỗi xảy ra";
            $(".profile-box").html('<div class="alert alert-danger">' + msg + "</div>");
        }
    });
});
</script>
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<h2>View Content</h2>
<div class="profile-box">
  <div class="login-header">View content list</div>
  <div class="profile-body">
    <table class="table table-bordered">
      <thead>
        <tr>
          <th>#</th>
          <th>Title</th>
          <th>Brief</th>
          <th>Create Date</th>
        </tr>
      </thead>
      <tbody id="content-table-body">
        <tr class="tab-content">
          <td>1</td>
          <td>Lorem ipsum dolor sit amet.</td>
          <td>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Nihil repellendus iure dolores laudantium harum minus.</td>
          <td>14/10/2003 10:30</td>
        </tr>
        <tr>
          <td>2</td>
          <td>Lorem ipsum dolor sit amet.</td>
          <td>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Nihil repellendus iure dolores laudantium harum minus.</td>
          <td>14/10/2003 10:30</td>
        </tr>
        <tr>
          <td>3</td>
          <td>Lorem ipsum dolor sit amet.</td>
          <td>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Nihil repellendus iure dolores laudantium harum minus.</td>
          <td>14/10/2003 10:30</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
<script>
$(document).ready(function() {
    $.ajax({
        url: "${pageContext.request.contextPath}/member/profile",
        type: "GET",
        dataType: "json",
        success: function(response) {
            const contentList = response.object;
            let rows = '';
            contentList.forEach(function(content) {
                const createDate = new Date(content.createDate[0], content.createDate[1] - 1, content.createDate[2], content.createDate[3], content.createDate[4], content.createDate[5]);
                const formattedDate = createDate.toLocaleString('en-GB', { day: '2-digit', month: '2-digit', year: 'numeric', hour: '2-digit', minute: '2-digit' });

                rows += `<tr>
                            <td>${content.id}</td>
                            <td>${content.title}</td>
                            <td>${content.brief}</td>
                            <td>${formattedDate}</td>
                         </tr>`;
            });

            $('#content-table-body').html(rows);
        },
        error: function(xhr) {
            const response = xhr.responseJSON;
            let msg = response && response.object ? response.object : "Có lỗi xảy ra";
            $(".profile-box").html('<div class="alert alert-danger">' + msg + "</div>");
        }
    });
});
</script>